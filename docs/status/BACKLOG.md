# Backlog

## Rules

1. Status must be one of: `todo`, `in_progress`, `blocked`, `done`.
2. Keep highest-priority items at top.
3. Update this file at the end of each implementation session.

## Items


| id          | title                                                                 | status      | owner | notes                                                                                   |
| ----------- | --------------------------------------------------------------------- | ----------- | ----- | --------------------------------------------------------------------------------------- |
| VS3-IMP-218 | Add deterministic received-unknown-field-list metadata for secret-ref unknown top-level payload errors | done | codex | `POST /secrets/refs` unknown top-level payload validation errors now include deterministic sorted `receivedUnknownTopLevelFields` metadata (unknown fields present in sorted `receivedTopLevelFields`) alongside deterministic `invalidField`, sorted unknown/allowed field metadata, and deterministic field/index metadata in API/WS-G tests and plan text |
| VS3-IMP-217 | Add deterministic received-allowed-field-index metadata for secret-ref unknown top-level payload errors | done | codex | `POST /secrets/refs` unknown top-level payload validation errors now include deterministic sorted `receivedAllowedTopLevelFieldIndexes` metadata (indexes into sorted `allowedTopLevelFields`) alongside deterministic `invalidField`, sorted unknown/allowed field metadata, and deterministic field/index metadata in API/WS-G tests and plan text |
| VS3-IMP-216 | Add deterministic missing-allowed-field-index metadata for secret-ref unknown top-level payload errors | done | codex | `POST /secrets/refs` unknown top-level payload validation errors now include deterministic sorted `missingAllowedTopLevelFieldIndexes` metadata (indexes into sorted `allowedTopLevelFields`) alongside deterministic `invalidField`, sorted unknown/allowed field metadata, and deterministic field/index metadata in API/WS-G tests and plan text |
| VS3-IMP-215 | Add deterministic missing-allowed-field-count metadata for secret-ref unknown top-level payload errors | done | codex | `POST /secrets/refs` unknown top-level payload validation errors now include deterministic `missingAllowedTopLevelFieldCount` metadata (count of missing allowed fields) alongside deterministic `invalidField`, sorted unknown/allowed field metadata, and deterministic field/index metadata in API/WS-G tests and plan text |
| VS3-IMP-214 | Add deterministic missing-allowed-field-list metadata for secret-ref unknown top-level payload errors | done | codex | `POST /secrets/refs` unknown top-level payload validation errors now include deterministic sorted `missingAllowedTopLevelFields` metadata (allowed fields absent from sorted `receivedTopLevelFields`) alongside deterministic `invalidField`, sorted unknown/allowed field metadata, and deterministic field/index metadata in API/WS-G tests and plan text |
| VS3-IMP-213 | Add deterministic received-allowed-field-list metadata for secret-ref unknown top-level payload errors | done | codex | `POST /secrets/refs` unknown top-level payload validation errors now include deterministic sorted `receivedAllowedTopLevelFields` metadata (allowed fields present in sorted `receivedTopLevelFields`) alongside deterministic `invalidField`, sorted unknown/allowed field metadata, and deterministic field/index metadata in API/WS-G tests and plan text |
| VS3-IMP-212 | Add deterministic received-allowed-field-count metadata for secret-ref unknown top-level payload errors | done | codex | `POST /secrets/refs` unknown top-level payload validation errors now include deterministic `receivedAllowedTopLevelFieldCount` metadata (count of allowed fields present in sorted `receivedTopLevelFields`) alongside deterministic `invalidField`, sorted unknown/allowed field metadata, and deterministic field/index metadata in API/WS-G tests and plan text |
| VS3-IMP-211 | Add deterministic allowed-field-index metadata for secret-ref unknown top-level payload errors | done | codex | `POST /secrets/refs` unknown top-level payload validation errors now include deterministic sorted `allowedTopLevelFieldIndexes` metadata (indexes into sorted `receivedTopLevelFields`) alongside deterministic `invalidField`, sorted `unknownFields`, index metadata, and deterministic field-count metadata in API/WS-G tests and plan text |
| VS3-IMP-210 | Add deterministic unknown-field-index metadata for secret-ref unknown top-level payload errors | done | codex | `POST /secrets/refs` unknown top-level payload validation errors now include deterministic sorted `unknownTopLevelFieldIndexes` metadata (indexes into sorted `receivedTopLevelFields`) alongside deterministic `invalidField`, sorted `unknownFields`, and deterministic field-count metadata in API/WS-G tests and plan text |
| VS3-IMP-209 | Add deterministic allowed-field-count metadata for secret-ref unknown top-level payload errors | done | codex | `POST /secrets/refs` unknown top-level payload validation errors now include deterministic `allowedTopLevelFieldCount` metadata alongside deterministic `invalidField`, sorted `unknownFields`, `unknownTopLevelFieldCount`, `receivedTopLevelFieldCount`, sorted `receivedTopLevelFields`, and sorted `allowedTopLevelFields` metadata in API/WS-G tests and plan text |
| VS3-IMP-208 | Add deterministic unknown-field-count metadata for secret-ref unknown top-level payload errors | done | codex | `POST /secrets/refs` unknown top-level payload validation errors now include deterministic `unknownTopLevelFieldCount` metadata alongside deterministic `invalidField`, sorted `unknownFields`, `receivedTopLevelFieldCount`, sorted `receivedTopLevelFields`, and sorted `allowedTopLevelFields` metadata in API/WS-G tests and plan text |
| VS3-IMP-207 | Add deterministic received-field-list metadata for secret-ref unknown top-level payload errors | done | codex | `POST /secrets/refs` unknown top-level payload validation errors now include deterministic sorted `receivedTopLevelFields` metadata alongside deterministic `invalidField`, `receivedTopLevelFieldCount`, sorted `unknownFields`, and sorted `allowedTopLevelFields` metadata in API/WS-G tests and plan text |
| VS3-IMP-206 | Add deterministic received-field-count metadata for secret-ref unknown top-level payload errors | done | codex | `POST /secrets/refs` unknown top-level payload validation errors now include deterministic `receivedTopLevelFieldCount` metadata alongside deterministic `invalidField`, sorted `unknownFields`, and sorted `allowedTopLevelFields` metadata in API/WS-G tests and plan text |
| VS3-IMP-205 | Add deterministic received-type metadata for secret-ref plaintext payload-key rejection | done | codex | `POST /secrets/refs` plaintext payload-key rejection now includes deterministic `receivedType` metadata for the offending key alongside deterministic `invalidField` and lexicographically sorted `forbiddenKeys` metadata in API/WS-G tests and plan text |
| VS3-IMP-204 | Add deterministic forbidden-key metadata for secret-ref plaintext payload-key rejection | done | codex | `POST /secrets/refs` plaintext payload-key rejection now includes deterministic `invalidField` and lexicographically sorted `forbiddenKeys` metadata in API/WS-G tests and plan text |
| VS3-IMP-203 | Add deterministic pattern metadata for secret-ref segment shape validation errors | done | codex | `POST /secrets/refs` segment shape validation (`provider`,`key`,`tenantSlug`) now includes deterministic `expectedPattern` and `receivedValue` metadata for invalid string-shape inputs in API/WS-G tests and plan text |
| VS3-IMP-202 | Add deterministic allowed-field metadata for secret-ref unknown top-level payload errors | done | codex | `POST /secrets/refs` unknown top-level payload validation errors now include deterministic `invalidField`, lexicographically sorted `unknownFields`, and lexicographically sorted `allowedTopLevelFields` metadata in API/WS-G tests and plan text |
| VS3-IMP-201 | Add deterministic format metadata for secret-ref invalid `ref` shape errors | done | codex | `POST /secrets/refs` invalid `ref` pattern validation now includes deterministic `invalidField`, `expectedFormat`, and `receivedRef` metadata in API/WS-G tests and plan text |
| VS3-IMP-200 | Add deterministic expected-vs-received metadata for secret-ref tenant reassignment conflicts | done | codex | `POST /secrets/refs` `secret_ref_conflict` tenant reassignment errors now include deterministic `invalidField`, `expectedTenantId`, and `receivedTenantId` metadata in API/WS-G tests and plan text |
| VS3-IMP-199 | Add deterministic expected-vs-received metadata for secret-ref segment mismatch errors | done | codex | `POST /secrets/refs` segment mismatch validation (`provider`,`key`,`tenantSlug`) now includes deterministic `expectedSegment` and `receivedSegment` metadata in API/WS-G tests and plan text |
| VS3-IMP-198 | Enforce optional secret-ref `tenantSlug` segment validation when provided with deterministic type metadata | done | codex | `POST /secrets/refs` now validates provided `tenantSlug` values via segment rules and returns deterministic `invalidField`, `expectedType`, and `receivedType` metadata for invalid types/shapes |
| VS3-IMP-197 | Add deterministic segment-field type metadata contract coverage for secret-ref segment validation | done | codex | `POST /secrets/refs` segment validation (`provider`,`key`) now has explicit deterministic `invalidField`, `expectedType`, and `receivedType` contract coverage in API/WS-G tests and plan text |
| VS3-IMP-196 | Add deterministic required-field type metadata contract coverage for secret-ref required fields | done | codex | `POST /secrets/refs` required `ref` and `tenantId` validation now has explicit deterministic `invalidField`, `expectedType`, and `receivedType` contract coverage in API/WS-G tests and plan text |
| VS3-IMP-195 | Add deterministic required-field type metadata contract coverage for public runtime resolve host query | done | codex | `GET /api/v1/public/runtime/resolve` host validation now has explicit deterministic `invalidField`, `expectedType`, and `receivedType` contract coverage in API/WS-E tests and plan text |
| VS3-IMP-194 | Add deterministic required-field type metadata contract coverage for public runtime snapshot site/version query | done | codex | `GET /api/v1/public/runtime/snapshot` query validation for `siteId`/`versionId` now has explicit deterministic `invalidField`, `expectedType`, and `receivedType` contract coverage in API/WS-E tests and plan text |
| VS3-IMP-193 | Add deterministic required-field type metadata contract coverage for public runtime snapshot by storage key | done | codex | `GET /api/v1/public/runtime/snapshot/by-storage-key` `storageKey` query validation now has explicit deterministic `invalidField`, `expectedType`, and `receivedType` contract coverage in API/WS-E tests and plan text |
| VS3-IMP-192 | Add deterministic required-field type metadata contract coverage for `overrides` | done | codex | `POST /sites/:siteId/overrides` required `draftId` validation now has explicit deterministic `invalidField`, `expectedType`, and `receivedType` contract coverage in API/WS-D tests and plan text |
| VS3-IMP-191 | Add deterministic required-field type metadata contract coverage for `publish` | done | codex | `POST /sites/:siteId/publish` required `draftId`/`proposalId` validation now has explicit deterministic `invalidField`, `expectedType`, and `receivedType` contract coverage in API/WS-F tests and plan text |
| VS3-IMP-190 | Add deterministic required-field type metadata contract coverage for `review/transition` | done | codex | `POST /sites/:siteId/review/transition` required `draftId`/`fromState`/`toState`/`event` validation now has explicit deterministic `invalidField`, `expectedType`, and `receivedType` contract coverage in API/WS-D tests and plan text |
| VS3-IMP-189 | Add deterministic required-field type metadata contract coverage for `compose/select` | done | codex | `POST /sites/:siteId/compose/select` required `draftId`/`proposalId` validation now has explicit deterministic `invalidField`, `expectedType`, and `receivedType` contract coverage in API/WS-D tests and plan text |
| VS3-IMP-188 | Add deterministic `invalidField` type metadata for required-string validation helper errors | done | codex | shared required-string helper validation now emits deterministic `invalidField`, `expectedType`, and `receivedType` metadata; compose-propose required-field API/WS-D coverage and contract text are aligned |
| VS3-IMP-187 | Standardize copy-slots `draftId` query validation metadata to deterministic `invalidField` | done | codex | `GET /sites/:siteId/copy/slots` missing/non-string `draftId` query validation now returns deterministic `invalidField`, `expectedType`, and `receivedType` metadata with API/WS-D coverage and contract text alignment |
| VS3-IMP-186 | Align rollback unknown-payload API contract text with deterministic `invalidField` metadata | done | codex | rollback contract wording now explicitly matches implemented `invalidField: payload` metadata behavior and existing API/WS-E assertions |
| VS3-IMP-185 | Standardize override payload field-level detail keys to `invalidField` | done | codex | override field-level `invalid_override_payload` errors now use deterministic `invalidField` metadata with API/WS-D coverage and contract text aligned |
| VS3-IMP-184 | Standardize runtime-resolve missing-host validation detail key to `invalidField` | done | codex | `GET /public/runtime/resolve` missing-host `validation_error` metadata now uses deterministic `invalidField: host` with API/WS-E coverage and contract text aligned |
| VS3-IMP-183 | Standardize bootstrap sitePolicy nested-boolean validation detail key to `invalidField` | done | codex | bootstrap `sitePolicy.allowOwnerDraftCopyEdits` validation errors now use deterministic `invalidField` metadata with API/WS-B coverage and contract text aligned |
| VS3-IMP-182 | Standardize plaintext-secret rejection detail key to `invalidField` | done | codex | plaintext secret payload-key rejection for secret-ref metadata writes now uses deterministic `invalidField` metadata for the offending key, with API/WS-G coverage and contract text aligned |
| VS3-IMP-181 | Standardize secret-ref conflict detail key to `invalidField` for tenant reassignment errors | done | codex | `secret_ref_conflict` responses now use deterministic `invalidField: tenantId` metadata for tenant reassignment attempts, with API/WS-G coverage and contract text aligned |
| VS3-IMP-180 | Standardize secret-ref validation detail key to `invalidField` for ref/segment checks | done | codex | secret-ref `validation_error` responses for required/segment checks now use deterministic `invalidField` metadata (`ref`,`tenantId`,`provider`,`key`,`tenantSlug`) with API/WS-G coverage and contract text aligned |
| VS3-IMP-179 | Add deterministic invalid-field metadata for secret-ref unknown top-level payload errors | done | codex | `POST /secrets/refs` unknown top-level payload validation errors now include deterministic `invalidField` metadata (`payload`) alongside sorted unknown-field details; API/WS-G coverage and contract text aligned |
| VS3-IMP-178 | Add deterministic invalid-field metadata for CMS webhook unknown top-level payload errors | done | codex | `POST /cms/webhooks/publish` unknown top-level payload validation errors now include deterministic `invalidField` metadata (`payload`) alongside sorted unknown-field details; API/WS-C coverage and contract text aligned |
| VS3-IMP-177 | Add deterministic invalid-field metadata for vertical-research unknown top-level payload errors | done | codex | `POST /verticals/:verticalKey/research/build` unknown top-level payload validation errors now include deterministic `invalidField` metadata (`payload`) alongside sorted unknown-field details; API/WS-B coverage and contract text aligned |
| VS3-IMP-176 | Add deterministic invalid-field metadata for bootstrap unknown top-level payload errors | done | codex | `POST /sites/:siteId/bootstrap-from-extraction` unknown top-level payload validation errors now include deterministic `invalidField` metadata (`payload`) alongside sorted unknown-field details; API/WS-B coverage and contract text aligned |
| VS3-IMP-175 | Add deterministic invalid-field metadata for tenant-create unknown top-level payload errors | done | codex | `POST /tenants` unknown top-level payload validation errors now include deterministic `invalidField` metadata (`payload`) alongside sorted unknown-field details; API/WS-B coverage and contract text aligned |
| VS3-IMP-174 | Add deterministic invalid-field metadata for rollback unknown top-level payload errors | done | codex | `POST /sites/:siteId/rollback/:versionId` unknown top-level payload validation errors now include deterministic `invalidField` metadata (`payload`) alongside sorted unknown-field details; API/WS-E coverage and contract text aligned |
| VS3-IMP-173 | Add deterministic invalid-field metadata for publish unknown top-level payload errors | done | codex | `POST /sites/:siteId/publish` unknown top-level payload validation errors now include deterministic `invalidField` metadata (`payload`) alongside sorted unknown-field details; API/WS-F coverage and contract text aligned |
| VS3-IMP-172 | Add deterministic invalid-field metadata for review-transition unknown top-level payload errors | done | codex | `POST /sites/:siteId/review/transition` unknown top-level payload validation errors now include deterministic `invalidField` metadata (`payload`) alongside sorted unknown-field details; API/WS-D coverage and contract text aligned |
| VS3-IMP-171 | Add deterministic invalid-field metadata for compose-select unknown top-level payload errors | done | codex | `POST /sites/:siteId/compose/select` unknown top-level payload validation errors now include deterministic `invalidField` metadata (`payload`) alongside sorted unknown-field details; API/WS-D coverage and contract text aligned |
| VS3-IMP-170 | Add deterministic invalid-field metadata for compose-propose unknown top-level payload errors | done | codex | `POST /sites/:siteId/compose/propose` unknown top-level payload validation errors now include deterministic `invalidField` metadata (`payload`) alongside sorted unknown field details; API/WS-D coverage and contract text aligned |
| VS3-IMP-169 | Add deterministic type metadata for override array-shape validation errors | done | codex | `POST /sites/:siteId/overrides` array-shape validation errors now include deterministic type metadata (`invalidField`, `expectedType`, `receivedType`) and item-type metadata (`invalidItemIndexes`, `expectedItemType`, `receivedItemTypes`) for non-array/non-string item payloads; API/WS-D coverage and contract text aligned |
| VS3-IMP-168 | Add deterministic invalid-field metadata for override unknown top-level payload errors | done | codex | `POST /sites/:siteId/overrides` unknown top-level payload validation errors now include deterministic `invalidField` metadata (`payload`) alongside sorted unknown/allowed field details; API/WS-D coverage and contract text aligned |
| VS3-IMP-167 | Add deterministic duplicate-index metadata for override duplicate-value validation errors | done | codex | `POST /sites/:siteId/overrides` duplicate-value validation errors now include deterministic `duplicateIndexes` metadata alongside sorted `duplicateValues` for operator triage; API/WS-D coverage and contract text aligned |
| VS3-IMP-166 | Add deterministic invalid-index metadata for override blank-string validation errors | done | codex | `POST /sites/:siteId/overrides` blank-string array-value validation errors now include deterministic `invalidIndexes` metadata alongside `field` for operator triage; API/WS-D coverage and contract text aligned |
| VS3-IMP-165 | Add deterministic no-op cardinality metadata for empty override payload errors | done | codex | `POST /sites/:siteId/overrides` empty/no-op override validation errors now include deterministic cardinality metadata (`minimumNonEmptyOverrideArrays`, `receivedNonEmptyOverrideArrays`) alongside sorted `fields`; API/WS-D coverage and contract text aligned |
| VS3-IMP-164 | Add deterministic allowed-section-keys metadata for override unknown section errors | done | codex | `POST /sites/:siteId/overrides` unknown section-key validation errors now include lexicographically sorted `allowedSectionKeys` metadata alongside sorted `unknownSections` for deterministic operator triage; API/WS-D coverage and contract text aligned |
| VS3-IMP-163 | Add deterministic allowed-component-ids metadata for override unknown component errors | done | codex | `POST /sites/:siteId/overrides` unknown `requiredComponents` validation errors now include lexicographically sorted `allowedComponentIds` metadata alongside sorted `unknownComponentIds` for deterministic operator triage; API/WS-D coverage and contract text aligned |
| VS3-IMP-162 | Add deterministic allowed-top-level-fields metadata for override unknown payload errors | done | codex | `POST /sites/:siteId/overrides` unknown top-level payload validation errors now include lexicographically sorted `allowedTopLevelFields` metadata alongside `unknownFields` for deterministic operator triage; API/WS-D coverage and contract text aligned |
| VS3-IMP-161 | Sort override no-op field-list detail arrays deterministically | done | codex | `POST /sites/:siteId/overrides` no-op payload validation errors now emit lexicographically sorted `fields` details for deterministic operator output; API/WS-D coverage and contract text aligned |
| VS3-IMP-160 | Sort override unknown-component detail arrays deterministically | done | codex | `POST /sites/:siteId/overrides` unknown required-component validation errors now emit lexicographically sorted `unknownComponentIds` details for deterministic operator output; API/WS-D coverage and contract text aligned |
| VS3-IMP-159 | Sort override conflicting-section detail arrays deterministically | done | codex | `POST /sites/:siteId/overrides` overlap validation errors now emit lexicographically sorted `conflictingSections` details for deterministic operator output; API/WS-D coverage and contract text aligned |
| VS3-IMP-158 | Sort override unknown-section detail arrays deterministically | done | codex | `POST /sites/:siteId/overrides` unknown section-key validation errors now emit lexicographically sorted `unknownSections` details for deterministic operator output; API/WS-D coverage and contract text aligned |
| VS3-IMP-157 | Sort override duplicate-value detail arrays deterministically | done | codex | `POST /sites/:siteId/overrides` duplicate array-value validation errors now emit lexicographically sorted `duplicateValues` details for deterministic operator output; API/WS-D coverage and contract text aligned |
| VS3-IMP-156 | Sort vertical-research invalid-sourceDomain detail arrays deterministically | done | codex | `POST /verticals/:verticalKey/research/build` invalid `sourceDomains` validation errors now emit deterministically sorted `invalidSourceDomains` details for stable operator output; API/WS-B coverage and contract text aligned |
| VS3-IMP-155 | Sort vertical-research invalid-source detail arrays deterministically | done | codex | `POST /verticals/:verticalKey/research/build` unsupported `sources` validation errors now emit lexicographically sorted `invalidSources` details for deterministic operator output; API/WS-B coverage and contract text aligned |
| VS3-IMP-154 | Sort vertical-research duplicate-sourceDomain detail arrays deterministically | done | codex | `POST /verticals/:verticalKey/research/build` duplicate `sourceDomains` validation errors now emit lexicographically sorted `duplicateSourceDomains` details for deterministic operator output; API/WS-B coverage and contract text aligned |
| VS3-IMP-153 | Sort vertical-research duplicate-source detail arrays deterministically | done | codex | `POST /verticals/:verticalKey/research/build` duplicate `sources` validation errors now emit lexicographically sorted `duplicateSources` details for deterministic operator output; API/WS-B coverage and contract text aligned |
| VS3-IMP-152 | Sort bootstrap extracted-field unknown-key detail arrays deterministically | done | codex | `POST /sites/:siteId/bootstrap-from-extraction` unknown nested `extractedFields` item-key validation errors now emit lexicographically sorted per-item `unknownFields` details for deterministic operator output; API/WS-B coverage and contract text aligned |
| VS3-IMP-151 | Sort bootstrap sitePolicy unknown-field detail arrays deterministically | done | codex | `POST /sites/:siteId/bootstrap-from-extraction` `sitePolicy` unknown-field validation errors now emit lexicographically sorted `unknownFields` details for deterministic operator output; API/WS-B coverage and contract text aligned |
| VS3-IMP-150 | Sort override-payload unknown-field detail arrays deterministically | done | codex | `POST /sites/:siteId/overrides` unknown top-level payload validation errors now emit lexicographically sorted `unknownFields` details for deterministic operator output; API/WS-D coverage and contract text aligned |
| VS3-IMP-149 | Sort secret-ref unknown-field detail arrays deterministically | done | codex | `POST /secrets/refs` unknown top-level payload validation errors now emit lexicographically sorted `unknownFields` details for deterministic operator output; API/WS-G coverage and contract text aligned |
| VS3-IMP-148 | Sort CMS publish-webhook unknown-field detail arrays deterministically | done | codex | `POST /cms/webhooks/publish` unknown top-level payload validation errors now emit lexicographically sorted `unknownFields` details for deterministic operator output; API/WS-C coverage and contract text aligned |
| VS3-IMP-147 | Sort rollback unknown-field detail arrays deterministically | done | codex | `POST /sites/:siteId/rollback/:versionId` unknown top-level payload validation errors now emit lexicographically sorted `unknownFields` details for deterministic operator output; API/WS-E coverage and contract text aligned |
| VS3-IMP-146 | Sort publish unknown-field detail arrays deterministically | done        | codex | `POST /sites/:siteId/publish` unknown top-level payload validation errors now emit lexicographically sorted `unknownFields` details for deterministic operator output; API/WS-F coverage and contract text aligned |
| VS3-IMP-145 | Sort review-transition unknown-field detail arrays deterministically | done        | codex | `POST /sites/:siteId/review/transition` unknown top-level payload validation errors now emit lexicographically sorted `unknownFields` details for deterministic operator output; API/WS-D coverage and contract text aligned |
| VS3-IMP-144 | Sort vertical-research-build unknown-field detail arrays deterministically | done        | codex | `POST /verticals/:verticalKey/research/build` unknown top-level payload validation errors now emit lexicographically sorted `unknownFields` details for deterministic operator output; API/WS-B coverage and contract text aligned |
| VS3-IMP-143 | Sort bootstrap unknown-field detail arrays deterministically | done        | codex | `POST /sites/:siteId/bootstrap-from-extraction` unknown top-level payload validation errors now emit lexicographically sorted `unknownFields` details for deterministic operator output; API/WS-B coverage and contract text aligned |
| VS3-IMP-142 | Sort tenant-create unknown-field detail arrays deterministically | done        | codex | `POST /tenants` unknown top-level payload validation errors now emit lexicographically sorted `unknownFields` details for deterministic operator output; API/WS-B coverage and contract text aligned |
| VS3-IMP-141 | Sort compose-select unknown-field detail arrays deterministically | done        | codex | `POST /sites/:siteId/compose/select` unknown top-level payload validation errors now emit lexicographically sorted `unknownFields` details for deterministic operator output; API/WS-D coverage and contract text aligned |
| VS3-IMP-140 | Sort compose-propose unknown-field detail arrays deterministically | done        | codex | `POST /sites/:siteId/compose/propose` unknown top-level payload validation errors now emit lexicographically sorted `unknownFields` details for deterministic operator output; API/WS-D coverage and contract text aligned |
| VS3-IMP-139 | Sort copy-generate duplicate-locale details deterministically | done        | codex | `POST /sites/:siteId/copy/generate` duplicate locale validation errors now emit lexicographically sorted `duplicateLocales` details for deterministic operator output; API/WS-D coverage and contract text aligned |
| VS3-IMP-138 | Sort copy-generate unsupported-locale detail arrays deterministically | done        | codex | `POST /sites/:siteId/copy/generate` unsupported locale validation errors now emit lexicographically sorted `unsupportedLocales` and `allowedLocales` details for deterministic operator output; API/WS-D coverage and contract text aligned |
| VS3-IMP-137 | Sort copy-generate unknown-field detail arrays deterministically | done        | codex | `POST /sites/:siteId/copy/generate` unknown top-level payload validation errors now emit lexicographically sorted `unknownFields` details alongside sorted `allowedTopLevelFields`; API/WS-D coverage and contract text aligned |
| VS3-IMP-136 | Add deterministic allowed-top-level-fields metadata for copy-generate unknown payload errors | done        | codex | `POST /sites/:siteId/copy/generate` unknown top-level payload validation errors now include deterministic `allowedTopLevelFields` metadata alongside `invalidField` and `unknownFields`; API/WS-D coverage and contract text aligned |
| VS3-IMP-135 | Add deterministic invalid-field metadata for copy-generate unknown top-level payload errors | done        | codex | `POST /sites/:siteId/copy/generate` unknown top-level payload field validation errors now include deterministic `invalidField` metadata (`payload`) alongside `unknownFields`; API/WS-D coverage and contract text aligned |
| VS3-IMP-134 | Add deterministic type metadata for copy-generate `highImpactOnlyThreeVariants` validation errors | done        | codex | `POST /sites/:siteId/copy/generate` invalid `highImpactOnlyThreeVariants` errors now include deterministic `expectedType`/`receivedType` metadata alongside `invalidField` and `allowedValue`; API/WS-D coverage and contract text aligned |
| VS3-IMP-133 | Add deterministic type metadata for copy-generate `locales` item validation errors | done        | codex | `POST /sites/:siteId/copy/generate` non-string `locales` item validation errors now include deterministic item type metadata (`expectedItemType`, `receivedItemTypes`) alongside `invalidField` and `invalidItemIndexes`; API/WS-D coverage and contract text aligned |
| VS3-IMP-132 | Add deterministic type metadata for copy-generate `locales` array validation errors | done        | codex | `POST /sites/:siteId/copy/generate` non-array `locales` validation errors now include deterministic `expectedType`/`receivedType` metadata alongside `invalidField`; API/WS-D coverage and contract text aligned |
| VS3-IMP-131 | Add deterministic type metadata for copy-generate `verticalStandardVersion` validation errors | done        | codex | `POST /sites/:siteId/copy/generate` missing/invalid `verticalStandardVersion` validation errors now include deterministic `expectedType`/`receivedType` metadata alongside `invalidField`; API/WS-D coverage and contract text aligned |
| VS3-IMP-130 | Add deterministic type metadata for copy-select per-item `locale` validation errors | done        | codex | `POST /sites/:siteId/copy/select` per-item invalid `locale` validation errors now include deterministic `expectedType`/`receivedType` metadata alongside `invalidField`, `selectionIndex`, and allowed locale details; API/WS-D coverage and contract text aligned |
| VS3-IMP-129 | Add deterministic type metadata for copy-select per-item `selectedBy` validation errors | done        | codex | `POST /sites/:siteId/copy/select` per-item invalid `selectedBy` validation errors now include deterministic `expectedType`/`receivedType` metadata alongside `invalidField`, `selectionIndex`, and allowed role details; API/WS-D coverage and contract text aligned |
| VS3-IMP-128 | Add deterministic type metadata for copy-select per-item `candidateId` validation errors | done        | codex | `POST /sites/:siteId/copy/select` per-item `candidateId` missing/invalid validation errors now include deterministic `expectedType`/`receivedType` metadata alongside `invalidField` and `selectionIndex`; API/WS-D coverage and contract text aligned |
| VS3-IMP-127 | Add deterministic type metadata for copy-select per-item `slotId` validation errors | done        | codex | `POST /sites/:siteId/copy/select` per-item `slotId` missing/invalid validation errors now include deterministic `expectedType`/`receivedType` metadata alongside `invalidField` and `selectionIndex`; API/WS-D coverage and contract text aligned |
| VS3-IMP-126 | Add deterministic type metadata for copy-select per-item object-shape validation errors | done        | codex | `POST /sites/:siteId/copy/select` per-item non-object selection validation errors now include deterministic `expectedType`/`receivedType` metadata alongside `invalidField` and `selectionIndex`; API/WS-D coverage and contract text aligned |
| VS3-IMP-121 | Add deterministic type metadata for copy-select `draftId` validation errors | done        | codex | `POST /sites/:siteId/copy/select` `draftId` validation errors now include deterministic `expectedType`/`receivedType` metadata alongside `invalidField` |
| VS3-IMP-122 | Add deterministic type metadata for copy-select `selections` array validation errors | done        | codex | `POST /sites/:siteId/copy/select` `selections` required/type errors now include deterministic `expectedType`/`receivedType` metadata alongside `invalidField` |
| VS3-IMP-123 | Add deterministic cardinality metadata for copy-select empty selections errors | done        | codex | `POST /sites/:siteId/copy/select` empty `selections` validation errors now include deterministic `minimumSelections`/`receivedSelections` metadata |
| VS3-IMP-124 | Add deterministic expected-role metadata for copy-select selectedBy actor-mismatch errors | done        | codex | `POST /sites/:siteId/copy/select` selectedBy actor-mismatch errors now include deterministic expected/received role metadata for operator triage |
| VS3-IMP-125 | Align copy-select top-level validation metadata contract docs and acceptance labels | done        | codex | WS-D and API test labels now explicitly call out deterministic top-level type/cardinality/role metadata requirements, aligned with `docs/plan/30-api.md` |
| VS3-IMP-116 | Add deterministic selection-index details for copy-select per-item object-shape errors | done        | codex | `POST /sites/:siteId/copy/select` per-item object-shape validation errors now include deterministic `selectionIndex` alongside `invalidField` |
| VS3-IMP-117 | Add deterministic selection-index details for copy-select per-item unknown-field errors | done        | codex | `POST /sites/:siteId/copy/select` per-item unknown-field validation errors now include deterministic `selectionIndex` alongside unknown/allowed field details |
| VS3-IMP-118 | Add deterministic selection-index details for copy-select per-item required-field errors | done        | codex | `POST /sites/:siteId/copy/select` per-item `slotId`/`locale`/`candidateId` validation errors now include deterministic `selectionIndex` |
| VS3-IMP-119 | Add deterministic selection-index details for copy-select per-item invalid-selectedBy errors | done        | codex | `POST /sites/:siteId/copy/select` per-item invalid `selectedBy` allow-list errors now include deterministic `selectionIndex` |
| VS3-IMP-120 | Align copy-select per-item selection-index contract docs and acceptance labels | done        | codex | `docs/plan/30-api.md` and WS-D acceptance labels now explicitly require deterministic per-item `selectionIndex` metadata for applicable validation failures |
| VS3-IMP-111 | Add deterministic selection-index details for copy-select missing-candidate errors | done        | codex | `POST /sites/:siteId/copy/select` `copy_candidate_not_found` errors now include deterministic `selectionIndex` for the failing selection tuple |
| VS3-IMP-112 | Add deterministic selection-index details for copy-select mismatch errors | done        | codex | `POST /sites/:siteId/copy/select` slot/locale mismatch validation errors now include deterministic `selectionIndex` for the failing tuple |
| VS3-IMP-113 | Add deterministic duplicate-tuple index details for copy-select duplicate tuple errors | done        | codex | `POST /sites/:siteId/copy/select` duplicate tuple validation errors now include deterministic first/duplicate selection indexes for operator triage |
| VS3-IMP-114 | Add deterministic selection-index details for copy-select selectedBy mismatch errors | done        | codex | `POST /sites/:siteId/copy/select` selectedBy actor-mismatch validation errors now include deterministic `selectionIndex` for the failing tuple |
| VS3-IMP-115 | Add deterministic index details for copy-select selection-level error family documentation | done        | codex | `docs/plan/30-api.md` + WS-D acceptance assertions now explicitly require selection-level index metadata where applicable |
| VS3-IMP-106 | Sort copy-select unknown top-level allowed-fields details deterministically | done        | codex | `POST /sites/:siteId/copy/select` unknown top-level payload field errors now emit lexicographically sorted `allowedTopLevelFields` values for deterministic operator output |
| VS3-IMP-107 | Sort copy-select unknown per-item allowed-fields details deterministically | done        | codex | `POST /sites/:siteId/copy/select` unknown per-item field errors now emit lexicographically sorted `allowedSelectionFields` values for deterministic operator output |
| VS3-IMP-108 | Sort copy-select invalid-locale allowed-values details deterministically | done        | codex | `POST /sites/:siteId/copy/select` invalid locale errors now emit lexicographically sorted `allowedLocales` values for deterministic operator output |
| VS3-IMP-109 | Sort copy-select invalid-selectedBy-role allowed-values details deterministically | done        | codex | `POST /sites/:siteId/copy/select` invalid `selectedBy` errors now emit lexicographically sorted `allowedSelectedByRoles` values for deterministic operator output |
| VS3-IMP-110 | Add deterministic tuple-alias details for copy-select missing-candidate errors | done        | codex | `POST /sites/:siteId/copy/select` `copy_candidate_not_found` errors now include explicit requested tuple aliases (`requestedSlotId`, `requestedLocale`) alongside existing tuple fields |
| VS3-IMP-102 | Add deterministic allowed-top-level-fields details for copy-select unknown payload errors | done        | codex | `POST /sites/:siteId/copy/select` unknown top-level payload field errors now include deterministic `allowedTopLevelFields` details alongside `invalidField` and `unknownFields` |
| VS3-IMP-103 | Add deterministic allowed-selection-fields details for copy-select unknown per-item fields | done        | codex | `POST /sites/:siteId/copy/select` unknown per-item selection field errors now include deterministic `allowedSelectionFields` details alongside `invalidField` and `unknownFields` |
| VS3-IMP-104 | Sort copy-select unknown-field detail arrays deterministically        | done        | codex | `POST /sites/:siteId/copy/select` unknown top-level and per-item field validation errors now emit lexicographically sorted `unknownFields` values for stable triage output |
| VS3-IMP-105 | Add deterministic candidate tuple comparison details for copy-select slot/locale mismatch errors | done        | codex | `POST /sites/:siteId/copy/select` slot/locale mismatch errors now include deterministic candidate tuple comparison details (`candidateSlotId`, `candidateLocale`, `requestedSlotId`, `requestedLocale`) |
| VS3-IMP-099 | Add deterministic allowed-locales details for copy-select per-item locale validation | done        | codex | `POST /sites/:siteId/copy/select` invalid locale values now return deterministic `allowedLocales` details alongside `invalidField` |
| VS3-IMP-100 | Add deterministic allowed-selectedBy-role details for copy-select per-item selectedBy validation | done        | codex | `POST /sites/:siteId/copy/select` invalid per-item `selectedBy` values now return deterministic `allowedSelectedByRoles` details alongside `invalidField` |
| VS3-IMP-101 | Add deterministic invalid-field details for copy-select unknown top-level payload fields | done        | codex | `POST /sites/:siteId/copy/select` unknown top-level payload field errors now include deterministic `invalidField` metadata (`payload`) in addition to `unknownFields` |
| VS3-IMP-097 | Add deterministic invalid-field details for copy-select `draftId` requirement | done        | codex | `POST /sites/:siteId/copy/select` now includes deterministic `invalidField` details when `draftId` is missing or non-string |
| VS3-IMP-098 | Add deterministic missing-candidate details for copy-select selection tuples | done        | codex | `POST /sites/:siteId/copy/select` `copy_candidate_not_found` now exposes deterministic candidate tuple details (`candidateId`, `slotId`, `locale`) for faster operator triage |
| VS3-IMP-094 | Standardize invalid-field details for copy-select top-level selection validation errors | done        | codex | `POST /sites/:siteId/copy/select` now returns deterministic `invalidField` details for empty-selections, candidate slot/locale mismatch, duplicate tuple, and selectedBy actor mismatch errors |
| VS3-IMP-095 | Standardize invalid-field details for copy-select per-item validation errors | done        | codex | `POST /sites/:siteId/copy/select` per-item validation errors now report deterministic `invalidField` keys (`selections[i]`, `selections[i].slotId`, `selections[i].locale`, etc.) |
| VS3-IMP-096 | Add deterministic missing-field details for copy-select `selections` array requirement | done        | codex | `POST /sites/:siteId/copy/select` now includes deterministic `invalidField` details when `selections` is missing or not an array |
| VS3-IMP-092 | Standardize invalid-field details for unsupported copy-generate locales | done        | codex | `POST /sites/:siteId/copy/generate` unsupported-locale validation now reports deterministic `validation_error` details using `invalidField` (replacing `field`) |
| VS3-IMP-093 | Add deterministic missing-field details for copy-generate `verticalStandardVersion` | done        | codex | `POST /sites/:siteId/copy/generate` now includes deterministic `validation_error` details (`invalidField`) when `verticalStandardVersion` is missing |
| VS3-IMP-087 | Require array type for copy-generate `locales` payload               | done        | codex | `POST /sites/:siteId/copy/generate` now rejects non-array provided `locales` values with deterministic `validation_error` details (`invalidField`) instead of coercing to empty; API/WS-D coverage added |
| VS3-IMP-088 | Require string items in copy-generate `locales` payload              | done        | codex | `POST /sites/:siteId/copy/generate` now rejects non-string `locales` array entries with deterministic `validation_error` details (`invalidField`, `invalidItemIndexes`); API/WS-D coverage added |
| VS3-IMP-089 | Reject duplicate values in copy-generate `locales` payload           | done        | codex | `POST /sites/:siteId/copy/generate` now rejects duplicate `locales` values with deterministic `validation_error` details (`invalidField`, `duplicateLocales`) instead of silently de-duplicating |
| VS3-IMP-090 | Add deterministic missing-locale details for copy-generate `locales` | done        | codex | `POST /sites/:siteId/copy/generate` now includes deterministic `validation_error` details (`invalidField`, `missingLocales`) when required locales (`cs-CZ`,`en-US`) are absent |
| VS3-IMP-091 | Standardize invalid-field details for `highImpactOnlyThreeVariants`  | done        | codex | `POST /sites/:siteId/copy/generate` now reports deterministic `validation_error` details with `invalidField` for high-impact mode validation errors |
| VS3-IMP-082 | Require boolean type for bootstrap `extractedFields[].required`       | done        | codex | `POST /sites/:siteId/bootstrap-from-extraction` now rejects invalid provided `required` values in `extractedFields` items with deterministic `validation_error` details (`invalidField`, `invalidItemIndexes`), preserving strict nested request-shape semantics; API/WS-B coverage added |
| VS3-IMP-083 | Require numeric type for bootstrap `extractedFields[].confidence`     | done        | codex | `POST /sites/:siteId/bootstrap-from-extraction` now rejects non-numeric provided `confidence` values in `extractedFields` items with deterministic `validation_error` details (`invalidField`, `invalidItemIndexes`), preserving strict nested request-shape semantics; API/WS-B coverage added |
| VS3-IMP-084 | Require in-range value for bootstrap `extractedFields[].confidence`   | done        | codex | `POST /sites/:siteId/bootstrap-from-extraction` now rejects provided `confidence` values outside `[0,1]` in `extractedFields` items with deterministic `validation_error` details (`invalidField`, `invalidItemIndexes`, `allowedRange`), avoiding silent clamping; API/WS-B coverage added |
| VS3-IMP-085 | Require non-empty string for bootstrap `extractedFields[].extractedAt` | done        | codex | `POST /sites/:siteId/bootstrap-from-extraction` now rejects non-string or blank provided `extractedAt` values in `extractedFields` items with deterministic `validation_error` details (`invalidField`, `invalidItemIndexes`); API/WS-B coverage added |
| VS3-IMP-086 | Require ISO-8601 parseable value for bootstrap `extractedFields[].extractedAt` | done        | codex | `POST /sites/:siteId/bootstrap-from-extraction` now rejects non-ISO-8601 provided `extractedAt` datetime strings in `extractedFields` items with deterministic `validation_error` details (`invalidField`, `invalidItemIndexes`); API/WS-B coverage added |
| VS3-IMP-081 | Enforce allow-list for bootstrap `extractedFields[].method`           | done        | codex | `POST /sites/:siteId/bootstrap-from-extraction` now rejects invalid provided `method` values in `extractedFields` items with deterministic `validation_error` details (`invalidField`, `invalidItemIndexes`, `allowedMethods`), preserving strict nested request-shape semantics; API/WS-B coverage added |
| VS3-IMP-080 | Require `extractedFields[].sourceUrl` to be non-empty string or null  | done        | codex | `POST /sites/:siteId/bootstrap-from-extraction` now rejects invalid provided `sourceUrl` values in `extractedFields` items with deterministic `validation_error` details (`invalidField`, `invalidItemIndexes`), preserving strict nested request-shape semantics; API/WS-B coverage added |
| VS3-IMP-079 | Require non-empty string type for bootstrap `extractedFields[].fieldPath` | done        | codex | `POST /sites/:siteId/bootstrap-from-extraction` now rejects non-string or blank `fieldPath` values when explicitly provided in `extractedFields` items with deterministic `validation_error` details (`invalidField`, `invalidItemIndexes`); API/WS-B coverage added |
| VS3-IMP-078 | Reject unknown nested fields in bootstrap `extractedFields` items     | done        | codex | `POST /sites/:siteId/bootstrap-from-extraction` now rejects unknown keys inside `extractedFields` items with deterministic `validation_error` details (`invalidField`, `invalidItemFields`), preserving strict nested request-shape semantics; API/WS-B coverage added |
| VS3-IMP-077 | Require object items in bootstrap `extractedFields` array             | done        | codex | `POST /sites/:siteId/bootstrap-from-extraction` now rejects non-object `extractedFields` items with deterministic `validation_error` details (`invalidField`, `invalidItemIndexes`), preserving strict nested request-shape semantics; API/WS-B coverage added |
| VS3-IMP-076 | Reject unknown nested fields in bootstrap `sitePolicy` payload        | done        | codex | `POST /sites/:siteId/bootstrap-from-extraction` now rejects unknown nested `sitePolicy` keys with deterministic `validation_error` details (`invalidField`, `unknownFields`), preserving strict nested request-shape semantics; API/WS-B coverage added |
| VS3-IMP-075 | Require object type for bootstrap `sitePolicy` payload                | done        | codex | `POST /sites/:siteId/bootstrap-from-extraction` now rejects non-object `sitePolicy` values with deterministic `validation_error` details (`invalidField`) when provided; API/WS-B coverage added |
| VS3-IMP-074 | Require boolean type for bootstrap `lowConfidence` payload            | done        | codex | `POST /sites/:siteId/bootstrap-from-extraction` now rejects non-boolean `lowConfidence` values with deterministic `validation_error` details (`invalidField`) instead of coercing truthy/falsy values; API/WS-B coverage added |
| VS3-IMP-073 | Require array type for bootstrap `extractedFields` payload            | done        | codex | `POST /sites/:siteId/bootstrap-from-extraction` now rejects non-array `extractedFields` values with deterministic `validation_error` details (`invalidField`) instead of coercing to empty; API/WS-B coverage added |
| VS3-IMP-072 | Add deterministic details for vertical research competitor-minimum validation | done        | codex | `POST /verticals/:verticalKey/research/build` now returns deterministic `insufficient_competitor_sample` details (`minimumTargetCompetitorCount`, `receivedTargetCompetitorCount`) when `targetCompetitorCount` violates the >=15 contract; API/WS-B coverage added |
| VS3-IMP-071 | Require array type for vertical research `sources` payload            | done        | codex | `POST /verticals/:verticalKey/research/build` now rejects non-array `sources` values with deterministic `validation_error` details (`invalidField`) instead of coercing to empty; API/WS-B coverage added |
| VS3-IMP-070 | Require array type for optional vertical research `sourceDomains` payload | done        | codex | `POST /verticals/:verticalKey/research/build` now rejects non-array `sourceDomains` values with deterministic `validation_error` details (`invalidField`) instead of silently treating them as omitted; API/WS-B coverage added |
| VS3-IMP-069 | Enforce numeric `targetCompetitorCount` payload type for vertical research build | done        | codex | `POST /verticals/:verticalKey/research/build` now rejects string-coerced `targetCompetitorCount` values and requires a numeric integer `>= 15`, preserving strict request-shape semantics; API/WS-B coverage added |
| VS3-IMP-068 | Reject duplicate vertical research `sourceDomains` values             | done        | codex | `POST /verticals/:verticalKey/research/build` now rejects duplicate `sourceDomains` values after trim/lowercase normalization with deterministic `validation_error` details (`duplicateSourceDomains`); API/WS-B coverage added |
| VS3-IMP-067 | Reject duplicate vertical research `sources` values                   | done        | codex | `POST /verticals/:verticalKey/research/build` now rejects duplicate source classes with deterministic `validation_error` details (`duplicateSources`) to preserve unambiguous source-policy inputs; API/WS-B coverage added |
| VS3-IMP-066 | Validate vertical research `sourceDomains` domain format              | done        | codex | `POST /verticals/:verticalKey/research/build` now rejects non-domain `sourceDomains` values (for example URLs or malformed hosts) with deterministic `validation_error` details and lowercases valid hostnames before de-duplication; API/WS-B coverage added |
| VS3-IMP-065 | Validate vertical research `sourceDomains` payload shape              | done        | codex | `POST /verticals/:verticalKey/research/build` now rejects non-string or blank `sourceDomains` entries with deterministic `validation_error` details and persists trim-normalized unique domain values; API/WS-B coverage added |
| VS3-IMP-064 | Enforce vertical research `sources` allow-list with validation details | done        | codex | `POST /verticals/:verticalKey/research/build` now returns deterministic `validation_error` details (`invalidSources`, `allowedSources`) when `sources` is empty or includes unsupported classes; API/WS-B coverage added |
| VS3-IMP-063 | Reject unknown `rollback` payload fields                              | done        | codex | `POST /sites/:siteId/rollback/:versionId` now rejects unknown top-level keys with deterministic `validation_error` details to enforce deterministic rollback request shape; API/WS-E coverage added |
| VS3-IMP-062 | Reject unknown `tenants` payload fields                               | done        | codex | `POST /tenants` now rejects unknown top-level keys with deterministic `validation_error` details to enforce deterministic tenant-create request shape; API/WS-B coverage added |
| VS3-IMP-061 | Reject unknown `bootstrap-from-extraction` payload fields             | done        | codex | `POST /sites/:siteId/bootstrap-from-extraction` now rejects unknown top-level keys with deterministic `validation_error` details to enforce deterministic draft bootstrap request shape; API/WS-B coverage added |
| VS3-IMP-060 | Reject unknown `verticals/*/research/build` payload fields            | done        | codex | `POST /verticals/:verticalKey/research/build` now rejects unknown top-level keys with deterministic `validation_error` details to enforce deterministic vertical-research request shape; API/WS-B coverage added |
| VS3-IMP-059 | Reject unknown `secrets/refs` payload fields                          | done        | codex | `POST /secrets/refs` now rejects unknown top-level keys with deterministic `validation_error` details to enforce strict secret metadata contract request shape; API/WS-G coverage added |
| VS3-IMP-058 | Reject unknown `cms/webhooks/publish` payload fields                  | done        | codex | `POST /cms/webhooks/publish` now rejects unknown top-level keys with deterministic `validation_error` details to enforce strict signed webhook contract request shape; API/WS-C coverage added |
| VS3-IMP-057 | Reject unknown `publish` payload fields                               | done        | codex | `POST /publish` now rejects unknown top-level keys with deterministic `validation_error` details to enforce deterministic release-gate request shape; API/WS-F coverage added |
| VS3-IMP-056 | Reject unknown `review/transition` payload fields                     | done        | codex | `POST /review/transition` now rejects unknown top-level keys with deterministic `validation_error` details to enforce deterministic request shape; API/WS-D coverage added |
| VS3-IMP-055 | Reject unknown `compose/select` payload fields                        | done        | codex | `POST /compose/select` now rejects unknown top-level keys with deterministic `validation_error` details to enforce deterministic request shape; API/WS-D coverage added |
| VS3-IMP-054 | Reject unknown `compose/propose` payload fields                       | done        | codex | `POST /compose/propose` now rejects unknown top-level keys with deterministic `validation_error` details to enforce deterministic prompt-contract request shape; API/WS-D coverage added |
| VS3-IMP-053 | Reject unknown `copy/generate` payload fields                         | done        | codex | `POST /copy/generate` now rejects unknown top-level keys with deterministic `validation_error` details to enforce deterministic request shape; API/WS-D coverage added |
| VS3-IMP-052 | Reject unknown `copy/select` payload fields                           | done        | codex | `POST /copy/select` now rejects unknown top-level keys and unknown per-selection fields with deterministic `validation_error` details; API/WS-D coverage added |
| VS3-IMP-051 | Reject unknown top-level fields in override payloads                  | done        | codex | `POST /overrides` now rejects unexpected top-level keys with deterministic `invalid_override_payload` details to prevent silent operator input drift; API/WS-D coverage added |
| VS3-IMP-050 | Reject blank override string values and normalize override arrays     | done        | codex | `POST /overrides` now trims override string-array values before validation/storage and rejects blank/whitespace entries with deterministic `invalid_override_payload` details; API/WS-D coverage added |
| VS3-IMP-049 | Require at least one non-empty override directive array               | done        | codex | `POST /overrides` now rejects no-op payloads that provide no non-empty override arrays with deterministic `invalid_override_payload` details; API/WS-D coverage added |
| VS3-IMP-048 | Enforce unique values in override array fields                        | done        | codex | `POST /overrides` now rejects duplicate values within override arrays using deterministic `invalid_override_payload` details; API/WS-D coverage added |
| VS3-IMP-047 | Reject conflicting override section directives                        | done        | codex | `POST /overrides` now rejects overlapping section directives across `requiredSections`/`excludedSections` and `pinnedSections`/`excludedSections` with deterministic `invalid_override_payload` details; API/WS-D coverage added |
| VS3-IMP-046 | Validate override section arrays against allowed section taxonomy     | done        | codex | `POST /overrides` now rejects unknown section keys in `requiredSections`, `excludedSections`, and `pinnedSections` with deterministic `invalid_override_payload` details; API/WS-D coverage added |
| VS3-IMP-045 | Validate override `requiredComponents` against loaded component contracts | done        | codex | `POST /overrides` now rejects unknown `requiredComponents` IDs with `invalid_override_payload`, while allowing known contract IDs; API/WS-D coverage added |
| VS3-IMP-044 | Enforce catalog-version component contract validation for compose flow | done        | codex | `compose/propose` now rejects unknown `catalogVersion` with `component_contract_not_found`, and `/component-contracts` now honors `catalogVersion` filtering; API/WS-D coverage added |
| VS3-IMP-043 | Enforce `copy/select` `selectedBy` actor provenance                  | done        | codex | `POST /copy/select` now validates `selectedBy` against authenticated actor role and stores server-derived selector role; API/WS-D coverage added |
| VS3-IMP-042 | Require at least one selection item in `copy/select`                 | done        | codex | `POST /copy/select` now rejects empty `selections` arrays with deterministic validation errors; API/WS-D coverage added |
| VS3-IMP-041 | Require `verticalStandardVersion` on `copy/generate` requests         | done        | codex | `POST /copy/generate` now requires `verticalStandardVersion`; API/WS-D coverage updated for prompt contract reproducibility |
| VS3-IMP-040 | Enforce unique slot-locale selections in `copy/select`               | done        | codex | `POST /copy/select` now rejects duplicate `slotId+locale` tuples in one request; API/WS-D coverage added |
| VS3-IMP-039 | Enforce copy-generate locale allow-list (`cs-CZ`,`en-US`)            | done        | codex | `POST /copy/generate` now rejects unsupported locales and de-duplicates locale inputs; API/WS-D coverage added |
| VS3-IMP-038 | Enforce `copy/select` request selection shape and candidate coherence | done        | codex | `POST /copy/select` now validates `slotId`/`locale`/`candidateId` and rejects candidate slot/locale mismatches; API/WS coverage updated |
| VS3-IMP-037 | Enforce `highImpactOnlyThreeVariants` copy-generate request contract  | done        | codex | `POST /copy/generate` now rejects non-`true` values when flag is provided; API/WS-D coverage added |
| VS3-IMP-036 | Enforce low-confidence review-required publish pre-gate               | done        | codex | Publish now blocks with `low_confidence_review_required` when required extraction TODOs remain; API/WS-B coverage added |
| VS3-IMP-035 | Allow owner copy selection only when site policy enables draft edits  | done        | codex | `POST /copy/select` now allows `owner` only when `sitePolicy.allowOwnerDraftCopyEdits` is enabled; API/WS-B coverage added |
| VS3-IMP-034 | Implement extraction bootstrap evidence normalization and TODO policy  | done        | codex | Bootstrap now stores normalized `ExtractedField` records, enforces low-confidence TODO nulling, and audits required TODO counts |
| VS3-IMP-033 | Enforce mandatory error envelope for all API error paths              | done        | codex | Unified error envelope (`code/message/requestId/details`) across error handler + 404 path with API/WS-A coverage |
| VS3-IMP-032 | Persist structured compose/copy prompt payloads in audit trail        | done        | codex | Compose/copy audit events now persist structured prompt payload contract fields with API/acceptance assertions |
| VS3-IMP-031 | Enforce auth for non-public v3 read endpoints                         | done        | codex | Added tenant-member/internal-admin role guard to non-public GET surfaces with API/WS-B coverage |
| VS3-IMP-030 | Enforce signed webhook verification and audit for CMS publish ingress | done        | codex | Added HMAC signature guard + `cms_publish_webhook_queued` audit trail with API/acceptance coverage |
| VS3-OPS-001 | Curate `.env` baseline from docs/plan and current runtime usage       | done        | codex | Trimmed `.env.example`, aligned README env docs, and prefilled local `.env` baseline   |
| VS3-DOC-001 | Revise plan/quality/security docs to vertical-intelligence-first spec | done        | codex | Includes ADR-005..007 and plan files 50/60/70                                           |
| VS3-DOC-002 | Cross-file naming consistency check (`00/10/20/30`)                   | done        | codex | Types and endpoint families aligned in docs                                             |
| VS3-IMP-001 | Create monorepo workspace structure (`apps/*`, `packages/*`)          | done        | codex | Scaffolded with workspace bridges; legacy runtime preserved                             |
| VS3-IMP-002 | Add TS toolchain (tsconfig, eslint, prettier, vitest baseline)        | done        | codex | Added root TS/ESLint/Prettier/Vitest baseline with legacy runtime compatibility         |
| VS3-IMP-003 | Implement `packages/schema` canonical contracts from docs             | done        | codex | Added TS+Zod contracts for extraction, vertical, component, copy, review, and overrides |
| VS3-IMP-004 | Add additive v3 API routes from updated `docs/plan/30-api.md`         | done        | codex | Added route skeletons for v3 lifecycle families while preserving existing endpoints     |
| VS3-IMP-005 | Implement review state transition guard service                       | done        | codex | Added dedicated guard service with reason codes (`state_mismatch`, `event_mismatch`, `reason_required`) |
| VS3-IMP-006 | Implement compose/copy skeleton with bounded slot validation          | done        | codex | Added deterministic compose IDs, slot model, and bounded candidate generation (`A/B/C` vs `SINGLE`) |
| VS3-IMP-007 | Implement publish gate skeleton (quality/security blockers)           | done        | codex | Added publish gate evaluator for quality `P0` and unresolved security `critical/high` |
| VS3-IMP-008 | Implement secret-ref metadata model and ACL (`internal_admin`)        | done        | codex | Added strict secret metadata validation, `internal_admin` ACL, and no-plaintext payload guard |
| VS3-IMP-009 | Implement ops review flow for variant selection and overrides         | done        | codex | Added proposal tracking, state-gated selection/overrides, and `internal_admin` transition ACL |
| VS3-IMP-010 | Implement public runtime snapshot rendering skeleton                  | done        | codex | Added host->active version resolution, immutable snapshot fetch endpoints, and public-web runtime client skeleton |
| VS3-IMP-011 | Add documentation acceptance test harness                             | done        | codex | Added executable docs+API acceptance harness covering rollout tests 1-8 and scenarios 4.1-4.4 |
| VS3-IMP-012 | Implement rollback active-version repoint for public runtime          | done        | codex | Rollback endpoint now reactivates exact prior immutable version and runtime resolve follows active pointer |
| VS3-IMP-013 | Enforce `internal_admin` ACL for publish and rollback                 | done        | codex | Publish/rollback now require `internal_admin`; regression tests cover forbidden and allowed paths |
| VS3-IMP-014 | Add runtime invariant test: post-publish draft edits don't change live snapshot | done        | codex | Added API + acceptance harness regression coverage proving live pointer stays on published immutable version |
| VS3-IMP-015 | Add storage-key-only runtime snapshot fetch path                      | done        | codex | Added `/public/runtime/snapshot/by-storage-key` endpoint and switched runtime client flow to resolve->storageKey fetch |
| VS3-IMP-016 | Add runtime latency baseline harness check                            | done        | codex | Added executable local resolve+snapshot latency threshold check in WS-E acceptance harness |
| VS3-IMP-017 | Add internal-admin audit event read endpoint                          | done        | codex | Added `/api/v1/audit/events` with internal-admin ACL and filter/limit support for privileged action trail inspection |
| VS3-IMP-018 | Add deterministic security gate reason-code output                    | done        | codex | Added `securityReasonCodes` (`security_blocked_critical|security_blocked_high|security_pass_non_blocking_only`) to publish gate results while preserving existing fields |
| VS3-IMP-019 | Add quality report gate-family output contract                        | done        | codex | Quality latest endpoint now returns deterministic COPY/LAYOUT/MEDIA/LEGAL gate outcomes and acceptance coverage |
| VS3-IMP-020 | Add security report artifact+gate output contract                     | done        | codex | Security latest endpoint now includes deterministic gate decision fields plus JSON/markdown/gate artifact paths with API+acceptance coverage |
| VS3-IMP-021 | Add WS-G secret rotation runbook artifact contract check              | done        | codex | Added `docs/security/SECRET_ROTATION_RUNBOOK.md`, indexed it in security docs, and enforced WS-G runbook/audit contract via acceptance test |
| VS3-IMP-022 | Add required security findings JSON contract fields to latest endpoint | done        | codex | Security latest endpoint now includes required top-level `findings` array plus explicit release/site/version metadata contract assertions in API+acceptance tests |
| VS3-IMP-023 | Persist and expose latest security gate report per publish attempt    | done        | codex | Publish attempts now persist normalized security findings + deterministic gate decision so `/security/latest` returns real blocked/non-blocking outcomes |
| VS3-IMP-024 | Emit audit events for publish blocked/succeeded attempts              | done        | codex | Publish now emits `ops_publish_blocked` and `ops_publish_succeeded` audit events with gate context, plus API/acceptance verification |
| VS3-IMP-025 | Emit audit events for copy selection mutations                        | done        | codex | `POST /copy/select` now emits `ops_copy_selected` events and API/acceptance tests verify provenance audit visibility |
| VS3-IMP-026 | Persist and expose latest quality gate report per publish attempt     | done        | codex | Publish attempts now persist normalized quality findings and gate-family outcomes so `/quality/latest` reflects real blocked/non-blocking states |
| VS3-IMP-027 | Enforce internal-admin ACL for tenant/bootstrap/vertical-build writes | done        | codex | Tenant create, extraction bootstrap, and vertical research build now require `internal_admin` and emit audit trail events with API/acceptance coverage |
| VS3-IMP-028 | Emit audit events for copy generation mutations                       | done        | codex | `POST /copy/generate` now emits `ops_copy_generated` entries and API/acceptance tests verify generation provenance audit visibility |
| VS3-IMP-029 | Enforce ACL for compose/copy mutating endpoints                       | done        | codex | Compose/copy mutating routes now require `internal_admin`; API and acceptance tests updated with explicit forbidden-role coverage |
